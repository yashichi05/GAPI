https://www.w3schools.com/jsref/dom_obj_event.asp
dom event

BUG
打商品時，不能連續有兩個相同的商品ISO碼，第一個會少扣，因為扣數量程式跑太快，試算表的資料還沒有更新 寫入的值會錯誤
發票送出時超過50筆會因為短時間連接數過多，google 會短暫拒絕連線。

POS 自動化
https://www.qa-knowhow.com/?p=2559


露天怪怪
取貨數量 能自動標記宅配的商品(有困難)
有讀取條更好
研究then promise
研究ajax 及製作統整頁面

欄位要放在sheetrange裡面 統一調用
續退訂單?
刪除訂單

sql 外連
http://sharedderrick.blogspot.com/2009/05/sql-server-2008-express-enable-remote.html

送出時要鎖定送出紐 (沒有必要)
googleapi function　物件化X (gapi塞在物件內會錯誤) 
-webkit-print-color-adjust: exact; 強制列印背景


        fctn: function (sgs,nowi,endi) {
            for (var i = now; i < end; i++) {
                var va = [[this.orders[i].receiptNumber]];
                if (sgs == 'Y') {
                    var prg = 'writesheetrange(sheetrange.' + this.nowbutton + 'ID.gid, sheetrange.' + this.nowbutton + 'ID.gname+String.fromCharCode(this.receiptCol.charCodeAt(0) - 1)+(this.RowIndex[i]+1), va)' //是松果貨運的話，寫入發票的前一欄
                } else {
                    var prg = 'writesheetrange(sheetrange.' + this.nowbutton + 'ID.gid, sheetrange.' + this.nowbutton + 'ID.gname+this.receiptCol+(this.RowIndex[i]+1), va)'
                }
                //console.log(prg)
                eval(prg)
            }
        },
        outputNumber: function (sgs) { //輸出輸入的發票號碼
            var forcount = Math.floor(this.orders.length/30)
            if (this.orders.length < 30) {
                this.fctn(sgs,0,this.orders.length)
            } else {
                for(var i = 0;i<forcount){
                    setTimeout(function(){this.fctn(sgs,i*30,(i+1)*30)},1000*(i+1))
                    
                }//執行30倍數的
                setTimeout(function(){this.fctn(sgs,forcount*30,this.orders.length)},1000*forcount) //執行剩下的
            }
        }